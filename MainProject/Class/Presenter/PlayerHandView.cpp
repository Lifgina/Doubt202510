//
// PlayerHandView.cpp
//

#include "PlayerHandView.h"

using namespace HE;

void PlayerHandView::Load()
{
	for (int i = 0; i < 52; i++) {
		m_playerHandSprites[i]= Sprite("CardsFront.png");
		RenderingPath->AddSprite(&m_playerHandSprites[i], 0); // ?????_?????O?p?X????
		m_playerHandSprites[i].params.enableDrawRect(Rectf(
			0.0f, 0.0f, 100.0f, 150.0f
		));
		m_playerHandSprites[i].params.siz = Math::Vector2(100.0f, 150.0f); // ?J?[?h??T?C?Y????
		m_playerHandSprites[i].params.pos = Math::Vector2(-1000.0f, 0.0f); // ?J?[?h???u???????
	}
}

void PlayerHandView::UpdatePlayerHands(PlayerData playerdata_)
{
	// ?v???C???[???D??X?V
	int playerHands = playerdata_.GetPlayerHands(); // ?v???C???[???D???????èÔ
	for (int i = 0; i < 52; i++) {
		int rank = playerdata_.GetCard(i).GetRank(); // ?J?[?h??????N??èÔ
		if (rank == 0) {
			m_playerHandSprites[i].params.pos = Math::Vector2(-1000.0f, 0.0f); // ?J?[?h???u???????
		}
		else {
			if (i < 25) {
				m_playerHandSprites[i].params.pos = Math::Vector2(50.0f * i, RenderingPath->GetLogicalHeight() - 200); // ?J?[?h???u????
			}
			else {
				m_playerHandSprites[i].params.pos = Math::Vector2(50.0f * (i-25), RenderingPath->GetLogicalHeight() - 100); // ?J?[?h???u????
			}
			
			int suit = playerdata_.GetCard(i).GetSuit(); // ?J?[?h??X?[?g??èÔ
			m_playerHandSprites[i].params.enableDrawRect(Rectf(
				100.0f * (rank - 1), 150.0f * (suit), 100.0f, 150.0f
			)); // ?J?[?h??`???`????

		}

	}

}

Math::Vector2 PlayerHandView::GetCardPosition(int index)
{
	// ?w?????C???f?b?N?X??J?[?h???u??èÔ
	if (index < 0 || index >= 52) {
		return Math::Vector2(-1000.0f, -1000.0f); // ??????C???f?b?N?X???????O???u????
	}
	return Math::Vector2(m_playerHandSprites[index].params.pos.x, m_playerHandSprites[index].params.pos.y); // ?J?[?h???u????
}